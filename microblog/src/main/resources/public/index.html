<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet"  href="./css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@700&display=swap"
      rel="stylesheet"
    />
    <title>Login</title>
  </head>

  <body class="bg-dark2 text-light  my-3">

      <h2 class=" my-3  text-center google-font">MICROBLOG</h2>
      <hr class="bg-white "/>
    <div class="container p-3">
        <div class="row">
            <div class="col-6 custom-scrollbar-css bg-dark2 ">
                
                <div  id="public">
                
                </div>
            </div>
            <div class="col-5 my-auto bg-white ml-auto ">
            <div> 
                <ul class="nav nav-tabs nav-justified bg-white " >
                    <li class="nav-item">
                      <a class="nav-link text-dark font-weight-bold text-uppercase" id="login-button">Login</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link text-dark font-weight-bold text-uppercase" id="register-button">Register</a>
                    </li>
                  </ul>
                <div class="container">

                <div id="login-form" class="was-validated">
                    <div class="form-group p-2">
                      <label class="text-dark">Email:</label>
                      <input type="text" class="form-control" id="email" placeholder="Enter email" name="uname" required>
                      <div class="invalid-feedback">Please fill out this field.</div>
                    </div>
                    <div class="form-group p-2">
                      <label class="text-dark">Password:</label>
                      <input type="password" class="form-control" id="password" placeholder="Enter password" name="pswd" required>                     
                      <div class="invalid-feedback">Please fill out this field.</div>
                    </div>
                    <div class="form-group p-2">
                    <button id="login" class="btn btn-outline-dark btn-block">LOGIN</button>
                    </div>
                  </div>

                  <div id="register-form" class="was-validated">
                    <div class="form-group p-2">
                      <label class="text-dark">Email:</label>
                      <input type="text" class="form-control" id="email" placeholder="Enter email" name="uname" required>
                      <div class="invalid-feedback">Please fill out this field.</div>
                    </div>
                    <div class="form-group p-2">
                        <label class="text-dark">Name:</label>
                        <input type="text" class="form-control" id="name" placeholder="Enter name" required>                     
                        <div class="invalid-feedback">Please fill out this field.</div>
                      </div>
                    <div class="form-group p-2">
                      <label class="text-dark">Password:</label>
                      <input type="password" class="form-control" id="password" placeholder="Enter password" name="pswd" required>                     
                      <div class="invalid-feedback">Please fill out this field.</div>
                    </div>
                    <div class="form-group p-2">
                      <button id="register" class="btn btn-outline-dark btn-block">SIGNUP</button>
                    </div>
                  </div>

                </div>
            </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){
            $("#register-form").hide();
            $.get("http://localhost:8080/blog/public",
                    (data, error) => {                 
                    	for(var i=0; i<data.length; i++)
                    	{
                    		 $("#public").append("\n\
                         <div class='card text-white shadow bg-dark mb-3'>\n\
                          <div class='card-header font-weight-bold border-bottom'>"+data[i].author+"</div>\n\
                          <div class='card-body'>\n\
                         <p class='card-text '>"+data[i].content+"<p></div>"
                          );
                    		 console.log(data[i].content);
                    	}                   
                });

            sessionStorage.clear();

            $("#register-button").click(function(){
            $("#login-form").hide();
            $("#register-form").show();
            });

            $("#login-button").click(function(){
            $("#login-form").show();
            $("#register-form").hide();
            });

            $("#login").click(e=>{
                e.preventDefault();
                let body = {
                    email:$("#email").val(),
                    password:$("#password").val()                   
                };
                var email = $("#email").val();
                sessionStorage.setItem("email",email);       	  
        	  $.get("http://localhost:8080/user/login",body,
                    (data, error) => {                 
                        if(error.err){
							console.log("error in login");
                        }
                        else{
                        	if(data.response == "success"){                       	                           
                            let url1 = "http://localhost:8080/Home.html";                       
                             $(location).attr('href',url1);       
                             }
                        	else{console.log("data false bruh!");}
                        }
                });
        	});

            $("#register").click(e=>{
                e.preventDefault();
                let body = {
                    email:$("#email").val(),
                    name:$("#name").val(),
                    password:$("#password").val()                   
                };
                var email = $("#email").val();
                sessionStorage.setItem("email",email);       	  
        	  $.post("http://localhost:8080/user/add",body,
                    (data, error) => {                 
                        if(error.err){
							console.log("error in signup");
                        }
                        else{
                        	if(data.response == "success"){                       	                           
                            let url1 = "http://localhost:8080/Home.html";                       
                             $(location).attr('href',url1);       
                             }
                        	else{console.log("data false bruh!");}
                        }
                });
        	});
        });
        </script>
  </body>
</html>